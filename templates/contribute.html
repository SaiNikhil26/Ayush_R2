<!DOCTYPE html>
<!-- Created By CodingNepal -->
<html lang="en" dir="ltr">
   <head>
      <meta charset="utf-8">
      <title>Contribute images</title>
      <link rel="stylesheet" href="{{url_for('static',filename='CSS/styles.css')}}">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
   </head>
   <style>
    @import url('https://fonts.googleapis.com/css?family=Poppins:400,500,600,700&display=swap');
*{
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Poppins', sans-serif;
}
html,body{
  display: grid;
  height: 100%;
  place-items: center;
  text-align: center;
}
.container{
  height: 350px;
  width: 430px;
  
  position: relative;
}
.container .wrapper{
  position: relative;
  height: 300px;
  width: 100%;

  border-radius: 10px;
  background: #fff;
  border: 2px dashed #c2cdda;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}
.wrapper.active{
  border: none;
}
.wrapper .image{
  position: absolute;
  height: 100%;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}
.wrapper img{
  height: 100%;
  width: 100%;
  object-fit: cover;
}
.wrapper .icon{
  font-size: 100px;
  color: #20ab88;
}
.wrapper .text{
  font-size: 20px;
  font-weight: 500;
  color: #5B5B7B;
}
.wrapper #cancel-btn i{
  position: absolute;
  font-size: 20px;
  right: 15px;
  top: 15px;
  background: radial-gradient(759px at 14% 22.3%, rgb(10, 64, 88) 0%, rgb(15, 164, 102) 90%);
  cursor: pointer;
  display: none;
}
.wrapper.active:hover #cancel-btn i{
  display: block;
}
.wrapper #cancel-btn i:hover{
    background: radial-gradient(759px at 14% 22.3%, rgb(10, 64, 88) 0%, rgb(15, 164, 102) 90%);
}
.wrapper .file-name{
  position: absolute;
  bottom: 0px;
  width: 100%;
  padding: 8px 0;
  font-size: 18px;
  color: #fff;
  display: none;
  background: radial-gradient(759px at 14% 22.3%, rgb(10, 64, 88) 0%, rgb(15, 164, 102) 90%);
}
.wrapper.active:hover .file-name{
  display: block;
}
.container #custom-btn{
  margin-top: 30px;
  display: block;
  width: 100%;
  height: 50px;
  border: none;
  outline: none;
  border-radius: 25px;
  color: #fff;
  font-size: 18px;
  font-weight: 500;
  letter-spacing: 1px;
  text-transform: uppercase;
  cursor: pointer;
  background: radial-gradient(759px at 14% 22.3%, rgb(10, 64, 88) 0%, rgb(15, 164, 102) 90%);
}
.absolute {
  position: absolute;
  top: 50px !important;
  inset: 0;
  display: inline-flex;
  flex-direction: row;
}
.justify-center{
  justify-content: center;
}
.bg-shape1{
width:clamp(200px,55%,400px);
height: 400px;
border-radius: 9999px;
position: relative;
animation: one 10s infinite;
}
.bg-shape2{

width:clamp(200px,55%,300px);

height: 300px;
border-radius: 9999px;
position: relative;
animation: two 10s infinite;
}

@keyframes one {
0%{left: 0px; top: 0px;}
25%{left: -100px; top: 70px;}
50%{left: 20px; top: 150px; }
75% { left: 50px; top: 100px;}
100% { left: 0px; top: 0px; }
}
@keyframes two{
0%{left: 0px; top: 0px;}
25%{left: 50px; top: 10px;}
50% { left: 100px; top: 50px;}     
75%{left: 50px; top: 100px;}
100%{left: 0px; top: 0px;}
}
.opacity-50{
opacity: .5;
}
.bg-blur{
filter: blur(90px);
}
.bg-primary{
background-color: rgb(29, 165, 33);
}
.bg-teal {
background-color: rgb(9, 119, 230);
}
.bg-purple{
background-color:  rgb(140,0,215);
}
/* Add CSS styling for the icon */
.back-link {
   position: absolute;
   top: 10px;
   right: 10px;
   color: #5B5B7B; /* Change the color as needed */
   text-decoration: none;
   font-size: 24px; /* Adjust the font size as needed */
   transition: color 0.3s ease-in-out;
}

.back-link:hover {
   color: #555; /* Change the hover color as needed */
}

   </style>
   <body>
      <a href="/" class="back-link"><i class="fas fa-right-to-bracket"></i></a>

    <div class="absolute">
      <div class="absolute inset-0 justify-center">
        <div class="bg-shape1 bg-teal opacity-50 bg-blur"></div>
        <div class="bg-shape2 bg-primary opacity-50 bg-blur"></div>
        <div class="bg-shapel bg-purple opacity-50 bg-blur"></div>
    </div>I
    </div>
      <div class="container">
         <div class="wrapper">
            <div class="image">
               <img src="" alt="">
            </div>
            <div class="content">
               <div class="icon">
                  <i class="fas fa-cloud-upload-alt"></i>
               </div>
               <div class="text">
                  No file chosen, yet!
               </div>
            </div>
            <div id="cancel-btn">
               <i class="fas fa-times"></i>
            </div>
            <div class="file-name">
               File name here
            </div>
         </div>
         <button onclick="defaultBtnActive()" id="custom-btn">Choose a file</button>
        <input id="default-btn" type="file" hidden type="submit">
      </div>
      <script>
  const wrapper = document.querySelector(".wrapper");
  const fileName = document.querySelector(".file-name");
  const defaultBtn = document.querySelector("#default-btn");
  const customBtn = document.querySelector("#custom-btn");
  const cancelBtn = document.querySelector("#cancel-btn i");
  const img = document.querySelector("img");
  let regExp = /[0-9a-zA-Z\^\&\'\@\{\}\[\]\,\$\=\!\-\#\(\)\.\%\+\~\_ ]+$/;

  function displaySuccessMessage(message) {
    // Create a div element for the success message
    const successMessage = document.createElement("div");
    successMessage.classList.add("success-message");

    // Add styling to the success message
    successMessage.style.color = "#fff"; // Text color
    successMessage.style.padding = "10px"; // Padding
    successMessage.style.borderRadius = "5px"; // Border radius
    successMessage.style.background = "radial-gradient(759px at 14% 22.3%, rgb(10, 64, 88) 0%, rgb(15, 164, 102) 90%)";
    successMessage.style.marginTop = "10px";
    successMessage.style.backgroundColor = "#38c172"; // Background color
    successMessage.style.borderRadius = "25px"

    // Set the message text
    successMessage.textContent = message;

    // Add the success message to the container
    const container = document.querySelector(".container");
    container.appendChild(successMessage);
  }

  function defaultBtnActive() {
    defaultBtn.click();
  }

  defaultBtn.addEventListener("change", function () {
    const file = this.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function () {
        const result = reader.result;
        img.src = result;
        wrapper.classList.add("active");
      };
      cancelBtn.addEventListener("click", function () {
        img.src = "";
        wrapper.classList.remove("active");
        defaultBtn.value = ""; // Clear the file input field
        fileName.textContent = "No file chosen, yet!";
      });
      reader.readAsDataURL(file);

      // Display file name
      fileName.textContent = file.name;

      // Send the file to the server
      const formData = new FormData();
      formData.append("file", file);

      fetch("/contribute", {
        method: "POST",
        body: formData,
      })
        .then((response) => {
          if (response.ok) {
            return response.json();
          } else {
            throw new Error("File upload failed.");
          }
        })
        .then((data) => {
          // Handle the response from the server (e.g., show a success message).
          displaySuccessMessage(data.message);
          console.log(data);
          
        })
        .catch((error) => {
          // Handle errors.
          console.error(error);
        });
    }
  });
  cancelBtn.addEventListener("click", function () {
      // Remove the success message if it exists
      const successMessage = document.querySelector(".success-message");
      if (successMessage) {
        successMessage.remove();
      }

      img.src = "";
      wrapper.classList.remove("active");
      defaultBtn.value = ""; // Clear the file input field
      fileName.textContent = "No file chosen, yet!";
    });

      </script>
   </body>
</html>